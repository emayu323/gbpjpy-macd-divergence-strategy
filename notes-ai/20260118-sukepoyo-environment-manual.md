# sukepoyo environment - 説明書

## 概要

1時間足の環境認識を行うTradingView用インジケーター。
トレンド方向、ダイバージェンス、RCIステージを視覚化し、エントリータイミングの判断を支援する。

---

## 機能一覧

| 機能 | 説明 |
|------|------|
| ZigZag | トレンドの高値・安値を結ぶライン |
| EMA (20/30/40) | パーフェクトオーダー判定用 |
| MACDダイバージェンス | Hidden/Regular、確定/見込み |
| RCI背景色 | 3段階ステージ表示 |
| ダウトレンド判定 | 基準高値/安値によるトレンド判定 |
| 情報テーブル | 右上に現在状態を表示 |

---

## 設定項目

### ZigZag (1H)
| 設定名 | デフォルト | 説明 |
|--------|-----------|------|
| Show ZigZag | ON | ZigZag表示ON/OFF |
| Depth | 12 | ピボット検出の深さ |
| Deviation | 5 | 偏差（ポイント） |
| Backstep | 3 | バックステップ |
| Line Color | 白 | ライン色 |
| Line Width | 2 | ライン幅 |

### MACD
| 設定名 | デフォルト | 説明 |
|--------|-----------|------|
| Fast | 6 | 短期EMA期間 |
| Slow | 13 | 長期EMA期間 |
| Signal | 4 | シグナル期間 |

### EMA (Perfect Order)
| 設定名 | デフォルト | 説明 |
|--------|-----------|------|
| Show EMA | ON | EMA表示ON/OFF |
| EMA 20 | 20 | 短期EMA期間 |
| EMA 30 | 30 | 中期EMA期間 |
| EMA 40 | 40 | 長期EMA期間 |
| PO時EMA間を着色 | ON | パーフェクトオーダー時に塗りつぶし |
| 着色透明度 | 85 | 塗りつぶしの透明度 |

### RCI Stage Background
| 設定名 | デフォルト | 説明 |
|--------|-----------|------|
| RCI背景色を表示 | ON | 背景色表示ON/OFF |
| RCI 短期 | 9 | 短期RCI期間 |
| RCI 中期 | 14 | 中期RCI期間 |
| RCI 長期 | 18 | 長期RCI期間 |
| RCI トリガー | 60 | 閾値（±60） |

### RCI BG Filter (EMA)
| 設定名 | デフォルト | 説明 |
|--------|-----------|------|
| EMAフィルター有効 | OFF | 価格がEMAより上=買いのみ、下=売りのみ |
| フィルターEMA期間 | 100 | フィルター用EMA期間 |
| フィルターEMAを表示 | ON | フィルターEMA表示ON/OFF |
| EMA抜け無効化 | OFF | EMAを一度抜けたら戻っても背景非表示 |

### RCI Hook Filter
| 設定名 | デフォルト | 説明 |
|--------|-----------|------|
| フックフィルター有効 | OFF | RCI短期が反転するまで背景非表示 |

### RCI BG Filter (PO)
| 設定名 | デフォルト | 説明 |
|--------|-----------|------|
| POフィルター有効 | OFF | POの方向と一致するRCI背景のみ表示 |

### RCI BG Filter (Dow)
| 設定名 | デフォルト | 説明 |
|--------|-----------|------|
| ダウフィルター有効 | OFF | ダウトレンド方向と一致する背景のみ表示 |
| ダウ基準線を表示 | OFF | base_high/base_low水平線を表示 |

### Divergence
| 設定名 | デフォルト | 説明 |
|--------|-----------|------|
| Show Divergence | ON | ダイバージェンス表示ON/OFF |
| Show Prospective Div | ON | 見込みダイバー（点線）表示 |
| Hidden Divergence | ON | Hiddenダイバー有効 |
| Regular Divergence | ON | Regularダイバー有効 |
| 各色設定 | - | ダイバージェンスラインの色 |

---

## 表示要素の解説

### パーフェクトオーダー（PO）
- **上昇PO**: EMA20 > EMA30 > EMA40 → 緑色で塗りつぶし
- **下降PO**: EMA20 < EMA30 < EMA40 → 赤色で塗りつぶし

### RCI背景色

| ステージ | 条件 | 色（買い） | 色（売り） |
|----------|------|-----------|-----------|
| Stage1 | 短期RCIが閾値突破 | 薄い赤 | 薄い青 |
| Stage2 | 短期+中期が閾値 | 中程度の赤 | 中程度の青 |
| Stage3 | 短期+中期+長期が閾値 | 濃い赤 | 濃い青 |

**動作**:
1. 短期RCIが-60以下で「買いarmed」状態になる
2. 中期RCIも-60以下 → Stage2へ昇格
3. 長期RCIも-60以下 → Stage3へ昇格
4. 短期RCIが0を超えるとリセット

### ダイバージェンス

| タイプ | 価格 | MACD | 意味 | 色 |
|--------|------|------|------|-----|
| Hidden Bullish | 安値切り上げ | 切り下げ | トレンド継続示唆 | 緑 |
| Hidden Bearish | 高値切り下げ | 切り上げ | トレンド継続示唆 | ピンク |
| Regular Bullish | 安値切り下げ | 切り上げ | 反転示唆 | 水色 |
| Regular Bearish | 高値切り上げ | 切り下げ | 反転示唆 | オレンジ |

- **実線**: 確定ダイバージェンス（ピボット確定後）
- **点線**: 見込みダイバージェンス（暫定ピボット）

### ダウトレンド判定

| 状態 | 条件 |
|------|------|
| 上昇トレンド | 高値切り上げ + 安値切り上げ |
| 下降トレンド | 高値切り下げ + 安値切り下げ |
| レンジ | 上記パターンが崩れた状態 |

---

## 情報テーブル（右上）

| 項目 | 表示内容 |
|------|----------|
| PO | ↑UP / ↓DN / --- |
| Dir | ZigZag方向 ↑ / ↓ |
| MACD | MACD値 |
| High | 直近確定高値 |
| Low | 直近確定安値 |
| Prosp | 見込みダイバー状態 |
| RCI | 現在のRCIステージ |
| Dow | ダウトレンド状態 |

---

## アラート

| アラート名 | トリガー条件 |
|-----------|-------------|
| RCIステージ | 買い・売りいずれかのステージ発生 |
| RCI買い | 買いステージのみ |
| RCI売り | 売りステージのみ |

**設定方法**:
1. チャートでインジケーターを右クリック
2. 「アラートを追加」を選択
3. 条件で「RCIステージ」等を選択
4. 通知方法を設定して作成

---

## 推奨使用方法

1. **環境認識**: パーフェクトオーダーとダウトレンドで大局を把握
2. **タイミング**: RCI背景色でエントリー準備
3. **確認**: ダイバージェンス（特にHidden）でトレンド継続を確認
4. **エントリー**: 5分足等の下位足でタイミングを取る

---

## バージョン情報

- PineScript v6
- 作成日: 2026年1月18日
