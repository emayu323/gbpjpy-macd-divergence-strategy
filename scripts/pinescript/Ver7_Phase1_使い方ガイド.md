# GBPJPY Ver7 Phase1 - 環境認識インジケーター 使い方ガイド

## 📊 概要

**Ver7_Phase1_Environment.pine** は、GBPJPY System Ver7の環境認識部分を独立させたインジケーターです。

### 主な機能

1. **4時間足50EMAトレンド判定**
2. **1時間足MACDダイバージェンス検出**
3. **エントリー可能状態の判定**
4. **リアルタイム状態表示**

---

## 🚀 TradingViewへの導入手順

### 1. インジケーター追加

1. TradingViewで **GBPJPY 5分足チャート** を開く
2. 「インジケーター」をクリック
3. 「Pine エディタ」タブを開く
4. `Ver7_Phase1_Environment.pine` の内容をコピー&ペースト
5. 「保存」→「チャートに追加」

### 2. 表示位置

- **メインチャート**（ローソク足と同じエリア）に表示されます
- 背景色と情報パネルで状態を表示

### 3. 推奨設定

デフォルト設定で問題ありませんが、調整可能な項目：

| 設定項目 | デフォルト | 説明 |
|---------|-----------|------|
| 4時間足EMA期間 | 50 | トレンド判定用EMA |
| MACD Fast | 6 | 短期EMA |
| MACD Slow | 13 | 長期EMA |
| MACD Signal | 4 | シグナルライン |
| ZigZag Depth | 12 | ピーク/ボトム検出感度 |
| ダイバージェンス有効期間 | 12時間 | 有効期限 |
| ダイバージェンスライン表示 | ON | ダイバージェンスライン表示/非表示 |
| トレンド背景色表示 | ON | トレンド背景色表示/非表示 |
| **エントリー可能背景色表示** | **ON** | **エントリー可能時の背景色表示/非表示** |

---

## 📈 チャートの見方

### ダイバージェンスライン（価格チャート上）

チャート上に自動描画されます：

| タイプ | 色 | スタイル | 意味 |
|-------|---|---------|------|
| **ヒドゥン買い** | 緑 | 破線 | 上昇トレンド継続 |
| **レギュラー買い** | 青 | 実線 | 反転上昇 |
| **ヒドゥン売り** | 赤 | 破線 | 下降トレンド継続 |
| **レギュラー売り** | オレンジ | 実線 | 反転下降 |

### 背景色（メインチャート）

メインチャートの背景色で状態を視覚的に把握できます：

| 背景色 | 状態 | 意味 |
|-------|------|------|
| **ライム（薄緑）** | **買いエントリー可能** | **トレンド+ダイバージェンス条件が揃った** |
| **フクシア（薄紫）** | **売りエントリー可能** | **トレンド+ダイバージェンス条件が揃った** |
| 緑（極薄） | 上昇トレンド | 4時間足が上昇トレンド |
| 赤（極薄） | 下降トレンド | 4時間足が下降トレンド |

**優先順位**: エントリー可能背景色 > トレンド背景色

### 情報パネル（右上）

リアルタイムで以下を表示：

| 項目 | 表示内容 |
|------|---------|
| **4H トレンド** | 上昇/下降/なし |
| **ダイバージェンス** | タイプと方向 |
| **残り時間** | 有効期限までの時間 |
| **エントリー** | 買い可能/売り可能/待機 |

---

## 🎯 実践的な使い方

### ✅ 買いエントリー可能の条件

1. **4H トレンド** = 上昇（緑）
2. **ダイバージェンス** = ヒドゥン買いまたはレギュラー買い
3. **残り時間** = 12時間以内
4. **エントリー** = 買い可能（ライム色）

→ **背景がライム色（薄緑）** になったら、5分足でRCIエントリーシグナルを待つ

### ❌ 売りエントリー可能の条件

1. **4H トレンド** = 下降（赤）
2. **ダイバージェンス** = ヒドゥン売りまたはレギュラー売り
3. **残り時間** = 12時間以内
4. **エントリー** = 売り可能（フクシア色）

→ **背景がフクシア色（薄紫）** になったら、5分足でRCIエントリーシグナルを待つ

---

## 🔔 アラート設定

### 推奨アラート

1. **買いセットアップ完了**
   - 条件: 上昇トレンド + 買いダイバージェンス
   - 使用タイミング: エントリー準備

2. **売りセットアップ完了**
   - 条件: 下降トレンド + 売りダイバージェンス
   - 使用タイミング: エントリー準備

### アラート設定手順

1. インジケーター名の右にある「…」をクリック
2. 「アラートを追加」を選択
3. 条件を選択
4. 通知方法を設定（アプリ通知、メール、Webhook等）
5. 「作成」

---

## 🔍 トラブルシューティング

### Q1: ダイバージェンスが表示されない

**原因**:
- ZigZag Depthが小さすぎる/大きすぎる
- トレンドとダイバージェンス方向が不一致

**解決策**:
- ZigZag Depthを10-15の範囲で調整
- トレンド状態を確認（上昇トレンドで買いダイバージェンスのみ有効）

### Q2: エントリー可能状態にならない

**チェック項目**:
1. トレンドは明確か？（緑または赤）
2. ダイバージェンスは検出されているか？
3. 有効期限内か？（残り時間 > 0）
4. トレンドとダイバージェンス方向が一致しているか？

### Q3: プロットが見づらい

**調整方法**:
- 「設定」→「表示設定」
- 「エントリー可能背景色表示」をOFF/ON（エントリーチャンスを強調）
- 「トレンド背景色表示」をOFF/ON（トレンド状態の背景色）
- 「ダイバージェンスライン表示」をOFF/ON（ダイバージェンスライン）

---

## 📝 重要な注意事項

### ⚠️ このインジケーターだけではトレードしない

Phase1は **環境認識のみ** です。実際のエントリーには：

1. ✅ **Phase1**: 環境認識（このインジケーター）
2. ⏳ **Phase2**: 5分足RCIシグナル（次のフェーズ）
3. ⏳ **Phase3**: SL/TP設定（統合版で実装）

**両方の条件が揃って初めてエントリー**します。

### 📊 推奨チャート構成

```
┌─────────────────────────────┐
│ GBPJPY 5分足（メインチャート） │
│                             │
│ ・価格アクション             │
│ ・Phase1環境認識（背景色）    │
│   - トレンド背景色          │
│   - エントリー可能背景色     │
│   - ダイバージェンスライン   │
│   - 情報パネル（右上）       │
│ ・（Phase2のシグナル予定）   │
└─────────────────────────────┘
```

---

## 🎓 学習のヒント

### ダイバージェンスの理解

1. **ヒドゥン・ダイバージェンス**
   - トレンド継続のシグナル
   - より信頼性が高い
   - Ver7の主力パターン

2. **レギュラー・ダイバージェンス**
   - トレンド反転のシグナル
   - 慎重に扱う
   - 確認が重要

### 練習方法

1. **過去チャートで検証**
   - リプレイ機能を使用
   - ダイバージェンス検出精度を確認
   - 12時間の有効期限感覚を養う

2. **リアルタイム観察**
   - 1-2週間観察
   - パターンの出現頻度を把握
   - アラートの精度を確認

---

## 📈 次のステップ

Phase1が正常に動作することを確認したら：

1. **Phase2開発**: 5分足RCIエントリーシグナル
2. **Phase3開発**: 統合版（Phase1 + Phase2 + SL/TP）

---

## 🔄 バージョン情報

- **Version**: Phase1 v1.0
- **作成日**: 2026年1月13日
- **対応戦略**: GBPJPY System Ver7 (50EMA単独判定版)
- **PineScript**: v6

---

## 📞 サポート

問題や改善提案は、プロジェクトのIssueで報告してください。

**開発リポジトリ**: https://github.com/emayu323/gbpjpy-macd-divergence-strategy

---

**重要**: このインジケーターは教育目的で開発されています。実際の取引前に必ずデモ口座でテストしてください。
